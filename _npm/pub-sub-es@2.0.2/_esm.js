/**
 * Bundled by jsDelivr using Rollup v2.79.1 and Terser v5.19.2.
 * Original file: /npm/pub-sub-es@2.0.2/src/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
const e=(()=>{try{return new window.BroadcastChannel("pub-sub-es")}catch(e){return{postMessage:()=>{}}}})(),s=(e,s)=>s?e.toLowerCase():e,t=(e,{caseInsensitive:t}={})=>(n,i,a=1/0)=>{const c=s(n,t);return e[c]||(e[c]=[],e.__times__[c]=[]),e[c].push(i),e.__times__[c].push(+a||1/0),{event:c,handler:i}},n=(e,{caseInsensitive:t}={})=>(n,i)=>{"object"==typeof n&&(i=n.handler,n=n.event);const a=s(n,t);if(!e[a])return;const c=e[a].indexOf(i);-1===c||c>=e[a].length||(e[a].splice(c,1),e.__times__[a].splice(c,1))},i=(e,s)=>()=>{e.forEach((e=>e(s)))},a=(t,{isGlobal:a,caseInsensitive:c,async:o}={})=>{const _=n(t);return(n,r,l={})=>{const b=s(n,c);if(!t[b])return;const u=[...t[b]];if(u.forEach(((e,s)=>{--t.__times__[b][s]<1&&_(b,e)})),o||l.async?setTimeout(i(u,r),0):i(u,r)(),a&&!l.isNoGlobalBroadcast)try{e.postMessage({event:b,news:r})}catch(e){if(!(e instanceof DOMException))throw e;console.warn(`Could not broadcast '${b}' globally. Payload is not clonable.`)}}},c=e=>()=>{Object.keys(e).filter((e=>"_"!==e[0])).forEach((s=>{e[s]=void 0,e.__times__[s]=void 0,delete e[s],delete e.__times__[s]}))},o=({async:e=!1,caseInsensitive:s=!1,stack:i={__times__:{}}}={})=>(i.__times__||(i.__times__={}),{publish:a(i,{async:e,caseInsensitive:s}),subscribe:t(i,{caseInsensitive:s}),unsubscribe:n(i,{caseInsensitive:s}),clear:c(i),stack:i}),_={__times__:{}},r={publish:a(_,{isGlobal:!0}),subscribe:t(_),unsubscribe:n(_),stack:_};e.onmessage=({data:{event:e,news:s}})=>r.publish(e,s,{isNoGlobalBroadcast:!0});export{o as createPubSub,o as default,r as globalPubSub};
